OpenAI API function calling
1. 함수 호출 기능
함수 호출 기능은 모델이 사전에 정의된 함수를 필요에 따라 실행하도록 도와주는 강력한 도구
이 기능을 통해 어시스턴트는 자체 지식에 없는 실시간 정보 조회나 복잡한 계산 작업 등을 외부 함수에 위임 가능
예를 들어 사용자가 날씨를 물어보면, 어시스턴트는 날씨 API와 연결된 함수를 호출하여 최신 기온을 가져온 뒤 응답

- 실시간/외부 데이터 활용: 모델이 최신 정보(날씨, 주가, 뉴스 등)를 함수로부터 받아와 답변에 반영가능
- 모델 한계 보완: 수학 계산, 데이터베이스 질의 등 모델이 직접 처리하기 어려운 요청을 외부 로직으로 해결가능
- 도메인 확장: 개발자가 정의한 임의의 함수로 모델의 기능을 확장할 수 있어, 특정 분야나 서비스에 특화된 어시스턴트를 구현가능

OpenAI의 GPT-3.5/4 모델 중 2023년 하반기 이후 출시된 버전들은 이 함수 호출 기능을 지원
모델에게 함수 목록을 제공하면, 질문 의도에 따라 적절한 함수를 선택해 필요한 인수를 함께 호출 형식으로 응답을 반환

2. API 키 설정 및 OpenAI 클라이언트 초기화
OpenAI API를 사용하기 위해 먼저 API 키를 준비
API 키는 OpenAI 계정의 대시보드에서 생성할 수 있으며, 노출되지 않도록 환경 변수 등에 저장하여 사용

3. 외부 함수 정의 및 테스트
예시로 날씨 정보를 가져오는 함수
사용자가 "서울 날씨 어때요?"라고 물어보면, 어시스턴트가 이 함수를 호출하여 실시간 날씨 정보를 얻어 답변
예를 위해 간단한 get_weather 함수를 정의
이 함수는 위도(latitude)와 경도(longitude)를 받아 해당 위치의 현재 기온을 섭씨로 반환
구현에는 오픈 메테오(Open-Meteo)라는 공개 기상 API를 사용하여, 주어진 좌표의 현재 기온 데이터를 가져옴
함수는 requests 라이브러리를 통해 API를 호출하고, 응답 JSON에서 온도 값을 추출하여 반환

4. 함수 툴 설정 및 모델 응답 생성
OpenAI API에 우리가 정의한 함수를 툴(tool)로 등록하고, 모델이 이 함수를 호출하도록 유도
이를 위해 먼저 tools라는 리스트에 함수 정보를 구성
각 함수 툴에는 이름(name), 설명(description), 그리고 매개변수(parameters) 스키마를 지정
아래 코드에서는 type: "function"으로 함수를 정의

5. 함수 호출 결과 처리 및 최종 답변
모델이 함수 호출 요청을 반환했다면, 이제 개발자 측에서 해당 함수를 실제로 실행하고 그 결과를 어시스턴트에게 전달








